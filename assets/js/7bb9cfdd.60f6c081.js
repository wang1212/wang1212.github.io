"use strict";(self.webpackChunkmy_blog=self.webpackChunkmy_blog||[]).push([[67558],{81938:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>a,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>l,toc:()=>d});var s=n(85893),r=n(11151);const i={title:"Web \u5e94\u7528\uff1a\u8f7b\u91cf\u7ea7\u72b6\u6001\u7ba1\u7406\u5de5\u5177 zustand",date:new Date("2021-11-18T00:14:00.000Z"),update:new Date("2021-11-18T00:14:00.000Z"),authors:"wang1212",tags:["\u8ba1\u7b97\u673a\u6280\u672f","Web","Web \u524d\u7aef","\u5e94\u7528\u72b6\u6001\u7ba1\u7406","React.js"],keywords:["\u8ba1\u7b97\u673a\u6280\u672f","Web","Web \u524d\u7aef","\u5e94\u7528\u72b6\u6001\u7ba1\u7406","React.js"],description:"Web \u7f51\u9875\u5411 Web \u5e94\u7528\u53d1\u5c55\u7684\u8fc7\u7a0b\u4e2d\uff0c\u52bf\u5fc5\u4f1a\u51fa\u73b0 Web \u9879\u76ee\u7684\u590d\u6742\u5316\u95ee\u9898\uff0c\u800c\u5728\u79fb\u52a8\u7aef\u573a\u666f\uff0c\u57fa\u4e8e React.js \u7684\u5e94\u7528\u4e2d\u5982\u4f55\u7ba1\u7406\u72b6\u6001\uff1fzustand \u4e5f\u8bb8\u503c\u5f97\u4e00\u8bd5\u3002"},c=void 0,l={permalink:"/computer-technology/web-frontend/web-app-model-zustand",editUrl:"https://github.com/wang1212/wang1212.github.io/tree/master/blog/computer-technology/web-frontend/web-app-model-zustand.md",source:"@site/blog/computer-technology/web-frontend/web-app-model-zustand.md",title:"Web \u5e94\u7528\uff1a\u8f7b\u91cf\u7ea7\u72b6\u6001\u7ba1\u7406\u5de5\u5177 zustand",description:"Web \u7f51\u9875\u5411 Web \u5e94\u7528\u53d1\u5c55\u7684\u8fc7\u7a0b\u4e2d\uff0c\u52bf\u5fc5\u4f1a\u51fa\u73b0 Web \u9879\u76ee\u7684\u590d\u6742\u5316\u95ee\u9898\uff0c\u800c\u5728\u79fb\u52a8\u7aef\u573a\u666f\uff0c\u57fa\u4e8e React.js \u7684\u5e94\u7528\u4e2d\u5982\u4f55\u7ba1\u7406\u72b6\u6001\uff1fzustand \u4e5f\u8bb8\u503c\u5f97\u4e00\u8bd5\u3002",date:"2021-11-18T00:14:00.000Z",tags:[{label:"\u8ba1\u7b97\u673a\u6280\u672f",permalink:"/tags/\u8ba1\u7b97\u673a\u6280\u672f"},{label:"Web",permalink:"/tags/web"},{label:"Web \u524d\u7aef",permalink:"/tags/web-\u524d\u7aef"},{label:"\u5e94\u7528\u72b6\u6001\u7ba1\u7406",permalink:"/tags/\u5e94\u7528\u72b6\u6001\u7ba1\u7406"},{label:"React.js",permalink:"/tags/react-js"}],readingTime:17.875,hasTruncateMarker:!0,authors:[{name:"\u4e0d\u5982\u6000\u5ff5",title:"Web \u524d\u7aef\u5de5\u7a0b\u5e08 (Web Front-end Engineer)",url:"https://github.com/wang1212",email:"mrwang1212@126.com",imageURL:"/img/authors/wang1212.png",key:"wang1212"}],frontMatter:{title:"Web \u5e94\u7528\uff1a\u8f7b\u91cf\u7ea7\u72b6\u6001\u7ba1\u7406\u5de5\u5177 zustand",date:"2021-11-18T00:14:00.000Z",update:"2021-11-18T00:14:00.000Z",authors:"wang1212",tags:["\u8ba1\u7b97\u673a\u6280\u672f","Web","Web \u524d\u7aef","\u5e94\u7528\u72b6\u6001\u7ba1\u7406","React.js"],keywords:["\u8ba1\u7b97\u673a\u6280\u672f","Web","Web \u524d\u7aef","\u5e94\u7528\u72b6\u6001\u7ba1\u7406","React.js"],description:"Web \u7f51\u9875\u5411 Web \u5e94\u7528\u53d1\u5c55\u7684\u8fc7\u7a0b\u4e2d\uff0c\u52bf\u5fc5\u4f1a\u51fa\u73b0 Web \u9879\u76ee\u7684\u590d\u6742\u5316\u95ee\u9898\uff0c\u800c\u5728\u79fb\u52a8\u7aef\u573a\u666f\uff0c\u57fa\u4e8e React.js \u7684\u5e94\u7528\u4e2d\u5982\u4f55\u7ba1\u7406\u72b6\u6001\uff1fzustand \u4e5f\u8bb8\u503c\u5f97\u4e00\u8bd5\u3002"},unlisted:!1,prevItem:{title:"Web \u524d\u7aef\u8c03\u8bd5\u5de5\u5177\uff1aSourceMap \u6587\u4ef6",permalink:"/computer-technology/web-frontend/tools-web-fee-debug-with-source-map"},nextItem:{title:"\u53c8\u8bfb\u6751\u4e0a\u6625\u6811",permalink:"/2021/11/15/life/reading/"}},a={authorsImageUrls:[void 0]},d=[{value:"\u8f7b\u91cf\u7ea7\u72b6\u6001\u7ba1\u7406\u65b9\u6848",id:"\u8f7b\u91cf\u7ea7\u72b6\u6001\u7ba1\u7406\u65b9\u6848",level:2},{value:"redux vs zustand",id:"redux-vs-zustand",level:2},{value:"<code>subscribe()</code>",id:"subscribe",level:3},{value:"<code>setState()</code> &amp;&amp; <code>dispatch()</code>",id:"setstate--dispatch",level:3},{value:"React.js \u9002\u914d",id:"reactjs-\u9002\u914d",level:3},{value:"\u8c03\u5f0f\u5de5\u5177",id:"\u8c03\u5f0f\u5de5\u5177",level:3},{value:"\u7ed3\u8bed",id:"\u7ed3\u8bed",level:2},{value:"\u53c2\u8003",id:"\u53c2\u8003",level:2}];function o(e){const t={a:"a",blockquote:"blockquote",code:"code",em:"em",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.a)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.em,{children:"\u6700\u540e\u66f4\u65b0\u4e8e 2021-11-18 00:14:00"})}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["\u57fa\u4e8e React.js \u7684 Web \u5e94\u7528\u5982\u4f55\u5b8c\u6210\u72b6\u6001\u7ba1\u7406\uff1f\u793e\u533a\u4e3b\u6d41\u65b9\u6848\u662f ",(0,s.jsx)(t.strong,{children:"react-redux"}),"\uff0c\u5176\u672c\u8d28\u4e0a\u57fa\u4e8e React \u7684 ",(0,s.jsx)(t.code,{children:"Context"})," \u7279\u6027\u5b9e\u73b0\uff0c\u5982\u679c\u5e94\u7528\u8db3\u591f\u7b80\u5355\uff0c\u5b9e\u9645\u4e0a\u7528 ",(0,s.jsx)(t.code,{children:"Context"})," \u624b\u5199\u4e00\u4e2a\u7b80\u5355\u7684\u72b6\u6001\u7ba1\u7406\u5de5\u5177\u5012\u4e5f\u5e76\u4e0d\u96be\u3002\u4e0d\u8fc7\uff0c\u8003\u8651\u5230\u5de5\u5177\u7684\u5b8c\u5584\u6027\u3001\u9879\u76ee\u7684\u5065\u58ee\u6027\uff0c\u901a\u5e38\u91c7\u7528\u8f83\u597d\u7684\u3001\u6210\u719f\u7684\u793e\u533a\u65b9\u6848\u3002\u5728\u79fb\u52a8\u7aef\u573a\u666f\u4e0b\uff0c",(0,s.jsx)(t.strong,{children:"react-redux"})," \u7565\u663e\u81c3\u80bf\uff0c\u8f7b\u91cf\u7ea7\u72b6\u6001\u7ba1\u7406\u5de5\u5177 ",(0,s.jsx)(t.strong,{children:"zustand"})," \u5012\u662f\u4e00\u4e2a\u4e0d\u9519\u7684\u66ff\u4ee3\u65b9\u6848\u3002"]}),"\n",(0,s.jsx)(t.h2,{id:"\u8f7b\u91cf\u7ea7\u72b6\u6001\u7ba1\u7406\u65b9\u6848",children:"\u8f7b\u91cf\u7ea7\u72b6\u6001\u7ba1\u7406\u65b9\u6848"}),"\n",(0,s.jsxs)(t.p,{children:["Web \u4f18\u5316\u4e2d\uff0c\u8d44\u6e90\u5927\u5c0f\u7684\u4f18\u5316\u662f\u91cd\u4e2d\u4e4b\u91cd\uff0c\u800c\u4e14\u4e5f\u662f\u6210\u672c\u6700\u4f4e\uff0c\u6536\u76ca\u6700\u9ad8\u7684\u4f18\u5316\u65b9\u5f0f\uff0c\u5728\u79fb\u52a8\u7aef\u573a\u666f\u4e0b\u5c24\u4e3a\u7a81\u51fa\u3002\u6bcf\u5728\u9879\u76ee\u4e2d\u5f15\u5165\u4e00\u4e2a\u5de5\u5177\u5e93\uff0c\u90fd\u8981\u8003\u8651\u662f\u5426\u6709\u66f4\u8f7b\u91cf\u7ea7\u7684\u66ff\u4ee3\u54c1\u3002\u4f17\u6240\u5468\u77e5\uff0c",(0,s.jsx)(t.strong,{children:"moment"})," \u5c31\u662f\u4e00\u4e2a\u5178\u578b\u7684\u4f8b\u5b50\uff0c\u6211\u901a\u5e38\u91c7\u7528 ",(0,s.jsx)(t.strong,{children:"dayjs"})," \u4f5c\u4e3a\u66ff\u4ee3\u65b9\u6848\u3002\u800c\u5728\u5e94\u7528\u72b6\u6001\u7ba1\u7406\u5de5\u5177\u7684\u9009\u62e9\u4e2d\uff0c\u53ef\u4ee5\u5229\u7528 Bundlephobia \u9996\u5148\u8bc4\u4f30\u4e00\u4e0b\u793e\u533a\u4e3b\u6d41\u65b9\u6848 ",(0,s.jsx)(t.strong,{children:"react-redux"}),"\u3002"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{}),(0,s.jsx)(t.th,{style:{textAlign:"right"},children:"MINIFIED"}),(0,s.jsx)(t.th,{style:{textAlign:"right"},children:"MINIFIED + GZIPPED"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.a,{href:"https://bundlephobia.com/package/redux@4.1.2",children:"redux@4.1.2"})}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"4.3kB"}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"1.6kB"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.a,{href:"https://bundlephobia.com/package/react-redux@7.2.6",children:"react-redux@7.2.6"})}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"16.2kB"}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"5.4kB"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"20.5kB"}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"7kB"})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["\u4ec5\u5fc5\u987b\u7684\u4f9d\u8d56\u5c31\u9700\u8981 ",(0,s.jsx)(t.strong,{children:"7kb"})," \u4e4b\u591a\uff0c\u800c\u6211\u4eec\u4e5f\u77e5\u9053\uff0credux \u4e0d\u4ec5\u662f\u4e00\u4e2a\u72b6\u6001\u7ba1\u7406\u5de5\u5177\uff0c\u5176\u540c\u65f6\u4e5f\u63d0\u5021\u4e00\u79cd\u4f18\u79c0\u7684\u6a21\u5f0f\uff0c\u5373\u6211\u4eec\u719f\u77e5\u7684\uff1a"]}),"\n",(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:"Store -> Dispatch -> Action -> Reducer -> Store"}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["\u800c\u8fd9\u79cd\u6a21\u5f0f\u9700\u8981\u6211\u4eec\u624b\u5199\u5927\u91cf\u7684\u6a21\u677f\u4ee3\u7801\uff0c\u4e8e\u662f\u5c31\u6709\u4e86\u5b98\u65b9\u89e3\u51b3\u65b9\u6848 ",(0,s.jsx)(t.strong,{children:"@reduxjs/toolkit"})," \u548c\u793e\u533a\u65b9\u6848 ",(0,s.jsx)(t.strong,{children:"@rematch/core"}),"\uff0c\u8fd9\u8fdb\u4e00\u6b65\u52a0\u5267\u4e86\u8d44\u6e90\u5927\u5c0f\u6240\u5e26\u6765\u7684\u5f71\u54cd\u3002"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"}}),(0,s.jsx)(t.th,{style:{textAlign:"right"},children:"MINIFIED"}),(0,s.jsx)(t.th,{style:{textAlign:"right"},children:"MINIFIED + GZIPPED"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"https://bundlephobia.com/package/@reduxjs/toolkit@1.6.2",children:"@reduxjs/toolkit@1.6.2"})}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"32.1kB"}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"10.5kB"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"https://bundlephobia.com/package/@rematch/core@2.2.0",children:"@rematch/core@2.2.0"})}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"4.7kB"}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"1.7kB"})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["\u7ecf\u8fc7\u5206\u6790\uff0c\u4e8b\u5b9e\u4e0a\u6211\u4eec\u53ef\u4ee5\u770b\u5230 redux \u7684\u6838\u5fc3\u4ee3\u7801\u5e93\u4ec5\u6709 ",(0,s.jsx)(t.strong,{children:"1.6kb"})," \u7684\u5927\u5c0f\uff0c\u4f46\u4e3a\u4e86\u9002\u914d React.js \u548c\u89e3\u51b3\u6a21\u677f\u4ee3\u7801\u7684\u95ee\u9898\uff0c\u81f3\u5c11\u4e5f\u8981\u589e\u52a0 ",(0,s.jsx)(t.strong,{children:"7.1kb"})," \u7684\u8d44\u6e90\u5927\u5c0f\u3002\u6362\u53e5\u8bdd\u8bf4\uff0c\u72b6\u6001\u7ba1\u7406\u5de5\u5177\u7684\u6838\u5fc3\u5b9e\u73b0\u5176\u5b9e\u662f\u6bd4\u8f83\u7b80\u5355\u7684\uff0c\u8fd9\u4e5f\u662f\u6838\u5fc3\u5e93\u8f83\u5c0f\u7684\u539f\u56e0\uff0c\u800c\u5728\u79fb\u52a8\u7aef\u573a\u666f\u4e0b\uff0c\u9879\u76ee\u4e00\u822c\u8f83\u4e3a\u7b80\u5355\u3001\u89c4\u6a21\u8f83\u5c0f\uff0c\u5bf9\u4e8e\u5de5\u5177\u7684\u6838\u5fc3\u9700\u6c42\u5176\u5b9e\u4e5f\u4ec5\u4ec5\u662f\u6ee1\u8db3\u5e94\u7528\u72b6\u6001\u7ba1\u7406\u5373\u53ef\u3002\u4e8e\u662f\uff0c",(0,s.jsx)(t.strong,{children:"zustand"})," \u793e\u533a\u65b9\u6848\u6210\u4e3a\u4e86\u6211\u7684\u4e00\u4e2a\u9009\u62e9\u3002"]}),"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{style:{textAlign:"left"}}),(0,s.jsx)(t.th,{style:{textAlign:"right"},children:"MINIFIED"}),(0,s.jsx)(t.th,{style:{textAlign:"right"},children:"MINIFIED + GZIPPED"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"https://bundlephobia.com/package/zustand@3.6.5",children:"zustand@3.6.5"})}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"2kB"}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"954B"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{style:{textAlign:"left"},children:(0,s.jsx)(t.a,{href:"https://bundlephobia.com/package/jotai@1.4.3",children:"jotai@1.4.3"})}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"6.1kB"}),(0,s.jsx)(t.td,{style:{textAlign:"right"},children:"2.5kB"})]})]})]}),"\n",(0,s.jsxs)(t.p,{children:["\u4e0a\u8868\u4e2d\uff0c\u8fd8\u5217\u51fa\u4e86 jotai\uff0c\u5b83\u4e0e zustand \u51fa\u81ea\u540c\u4e00\u4e2a\u5f00\u53d1\u8005\u7fa4\u4f53\u4e4b\u624b\uff0c\u524d\u8005\u4ec5\u9002\u7528\u4e8e React.js \u7ec4\u4ef6\u5185\u7684\u72b6\u6001\u7ba1\u7406\uff0c\u800c\u540e\u8005\u8fd8\u9002\u7528\u4e8e\u7ec4\u4ef6\u4e4b\u5916\u7684\u72b6\u6001\u64cd\u4f5c\u3002",(0,s.jsx)(t.strong,{children:"zustand"})," \u8db3\u591f\u7b80\u5355\uff0c\u4e14\u65e0\u9700\u592a\u591a\u6a21\u677f\u4ee3\u7801\uff0c\u4ec5 ",(0,s.jsx)(t.strong,{children:"954B"})," \u5927\u5c0f\u5373\u53ef\u6ee1\u8db3\u5e94\u7528\u72b6\u6001\u7ba1\u7406\u7684\u6838\u5fc3\u9700\u6c42\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"\u81f3\u6b64\uff0c\u79fb\u52a8\u7aef\u573a\u666f\u4e0b\uff0c\u8981\u66ff\u4ee3 react-redux \u8fd9\u79cd\u4e3b\u6d41\u65b9\u6848\uff0c\u8003\u8651\u4ee5\u4e0b\u51e0\u70b9\uff1a"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"\u6ee1\u8db3\u5e94\u7528\u72b6\u6001\u7ba1\u7406\u7684\u6838\u5fc3\u9700\u6c42"}),"\n",(0,s.jsx)(t.li,{children:"\u5177\u5907\u8d44\u6e90\u5927\u5c0f\u4f18\u52bf"}),"\n",(0,s.jsx)(t.li,{children:"\u7528\u6cd5\u8db3\u591f\u7b80\u5355"}),"\n",(0,s.jsx)(t.li,{children:"\u65b9\u6848\u6210\u719f\uff08\u8f83\u591a\u4eba\u91c7\u7528\u3001\u6709\u914d\u5957\u7684\u8c03\u8bd5\u5de5\u5177\u7b49\uff09"}),"\n",(0,s.jsx)(t.li,{children:"\u53ef\u5728\u7ec4\u4ef6\u5916\u64cd\u4f5c\u72b6\u6001"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"\u5176\u4e2d\uff0c\u53ef\u5728\u7ec4\u4ef6\u5916\u64cd\u4f5c\u72b6\u6001\u8fd9\u4e00\u70b9\u5176\u5b9e\u662f\u4e3a\u4e86\u6ee1\u8db3\u65b9\u6848\u7684\u7075\u6d3b\u6027\uff0c\u6709\u65f6\u5019\u4e1a\u52a1\u9700\u6c42\u7684\u5b9e\u73b0\u53ef\u80fd\u4f1a\u6d89\u53ca\u5230\u5728\u7ec4\u4ef6\u4e4b\u5916\u8fdb\u884c\u72b6\u6001\u64cd\u4f5c\u7684\u573a\u666f\uff0c\u8fd9\u4e2a\u65f6\u5019\u5c31\u5f88\u65b9\u4fbf\u4e86\u3002"}),"\n",(0,s.jsx)(t.h2,{id:"redux-vs-zustand",children:"redux vs zustand"}),"\n",(0,s.jsx)(t.p,{children:"\u63a5\u4e0b\u6765\uff0c\u5206\u6790\u4e00\u4e0b\u4e24\u8005\u7684\u6e90\u7801\u5b9e\u73b0\uff0c\u5373\u53ef\u4e86\u89e3\u662f\u5426 zustand \u53ef\u4f5c\u4e3a\u4e00\u4e2a\u8f83\u597d\u7684\u66ff\u4ee3\u65b9\u6848\u3002\u5206\u4e24\u6b65\u8fdb\u884c\uff0c\u7b2c\u4e00\u6b65\u9996\u5148\u6765\u770b\u770b\u4e24\u8005\u7684\u6838\u5fc3\u5b9e\u73b0\uff0c\u5373\u72b6\u6001\u7ba1\u7406\u7684\u673a\u5236\u3002"}),"\n",(0,s.jsx)(t.p,{children:"\u9996\u5148\uff0c\u6211\u4eec\u8981\u660e\u767d\u72b6\u6001\u7ba1\u7406\u505a\u7684\u662f\u4ec0\u4e48\u4e8b\u60c5\u3002\u72b6\u6001\u5373\u6570\u636e\uff0c\u5bf9\u4e8e\u4e00\u4e2a\u539f\u751f\u7684 Web \u5e94\u7528\u6765\u8bf4\uff0c\u67d0\u4e00\u65f6\u523b\u9875\u9762\u5c55\u793a\u7684\u7ed3\u6784\u548c\u6837\u5f0f\u53d6\u51b3\u4e8e\u6b64\u65f6\u7684\u72b6\u6001\uff0c\u72b6\u6001\u53ef\u80fd\u4f1a\u7531\u4e8e\u7528\u6237\u4ea4\u4e92\u52a8\u4f5c\u53d1\u751f\u53d8\u5316\u3002Web \u5e94\u7528\u6709\u5f88\u591a\u72b6\u6001\uff0c\u6bd4\u5982\u8868\u5355\u7684\u52fe\u9009\u6309\u94ae\u72b6\u6001\uff0c\u6211\u4eec\u53ef\u4ee5\u5c06\u8fd9\u79cd\u72b6\u6001\u89c6\u4e3a\u5c40\u90e8\u72b6\u6001\uff0c\u8be5\u72b6\u6001\u7684\u53d8\u5316\u4e0d\u4f1a\u5bfc\u81f4\u9875\u9762\u5176\u5b83\u90e8\u5206\u53d1\u751f\u53d8\u5316\uff1b\u5f53\u7136\uff0c\u5982\u679c\u6211\u4eec\u5c06\u7528\u6237\u4f53\u9a8c\u8bbe\u8ba1\u66f4\u8fdb\u4e00\u6b65\uff0c\u52fe\u9009\u6309\u94ae\u7684\u72b6\u6001\u4f1a\u540c\u6b65\u5f71\u54cd\u8868\u5355\u63d0\u4ea4\u6309\u94ae\u662f\u5426\u5904\u4e8e\u53ef\u70b9\u51fb\u7684\u72b6\u6001\uff0c\u6b64\u65f6\u4e00\u4e2a\u72b6\u6001\u5728\u9875\u9762\u4e24\u4e2a\u90e8\u5206\u90fd\u6709\u5f71\u54cd\uff0c\u5bf9\u4e8e\u66f4\u590d\u6742\u7684 Web \u5e94\u7528\u6765\u8bf4\uff0c\u4e00\u4e2a\u72b6\u6001\u53ef\u80fd\u5f71\u54cd\u5230\u9875\u9762\u6570\u5341\u4e2a\u90e8\u5206\uff0c\u6211\u4eec\u5c31\u9700\u8981\u5bf9\u72b6\u6001\u7684\u7ef4\u62a4\u66f4\u65b0\u673a\u5236\u8fdb\u884c\u8bbe\u8ba1\uff0c\u5c06\u72b6\u6001\u7684\u7ef4\u62a4\u4ece\u9875\u9762\u8fdb\u884c\u89e3\u8026\uff0c\u72ec\u7acb\u5230\u5168\u5c40\u6765\u8fdb\u884c\uff0c\u5219\u5c06\u8fd9\u79cd\u72b6\u6001\u79f0\u4e4b\u4e3a\u5168\u5c40\u72b6\u6001\u3002\u663e\u7136\uff0c\u5bf9\u4e8e\u5c40\u90e8\u72b6\u6001\u6765\u8bf4\uff0c\u9875\u9762\u5c40\u90e8\u53ef\u4ee5\u5b8c\u6210\u81ea\u6cbb\uff0c\u800c\u5bf9\u4e8e\u5168\u5c40\u72b6\u6001\u6765\u8bf4\uff0c\u5219\u9700\u8981\u4e00\u4e2a\u5168\u5c40\u4e2d\u5fc3\u5316\u7684\u201c\u6570\u636e\u5e93\u201d\u6765\u8fdb\u884c\u7ba1\u7406\u3002"}),"\n",(0,s.jsx)(t.p,{children:"\u73b0\u5728\uff0c\u6211\u4eec\u53ef\u4ee5\u77e5\u9053\uff0c\u72b6\u6001\u7ba1\u7406\u9700\u8981\u63d0\u4f9b\u4e00\u4e2a\u7c7b\u4f3c\u4e2d\u5fc3\u5316\u7684\u201c\u6570\u636e\u5e93\u201d\uff0c\u540c\u65f6\u5bf9\u4e8e\u72b6\u6001\u8981\u63d0\u4f9b\u66f4\u65b0\u673a\u5236\uff0c\u800c\u72b6\u6001\u53ef\u4ee5\u88ab\u591a\u4e2a\u90e8\u5206\u4f9d\u8d56\uff0c\u72b6\u6001\u66f4\u65b0\u7684\u540c\u65f6\u4f9d\u8d56\u65b9\u53ef\u4ee5\u53ca\u65f6\u83b7\u53d6\u5230\u6700\u65b0\u72b6\u6001\u3002\u8fd9\u4e0d\u5c31\u662f\u8f6f\u4ef6\u67b6\u6784\u4e2d\u5178\u578b\u7684\u53d1\u5e03/\u8ba2\u9605\u6a21\u5f0f\u5417\uff1f\u6240\u4ee5\uff0c\u5148\u6765\u770b\u770b redux \u548c zustand \u4e24\u8005\u63d0\u4f9b\u7684 API\uff0c\u5927\u81f4\u5c31\u80fd\u7406\u89e3\u5176\u6838\u5fc3\u5b9e\u73b0\u7684\u6a21\u578b\u3002"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"// Redux (https://redux.js.org/api/api-reference)\ncreateStore(reducer, [preloadedState], [enhancer]);\n// Store\ngetState();\nsubscribe(listener);\ndispatch(action);\n\n// zustand (https://github.com/pmndrs/zustand)\ncreateStore();\n// Store\ngetState();\nsubscribe();\nsetState();\n"})}),"\n",(0,s.jsx)(t.p,{children:"\u7531\u6b64\u53ef\u89c1\uff0c\u4e24\u8005\u63d0\u4f9b\u7684\u6838\u5fc3 API \u662f\u975e\u5e38\u76f8\u8fd1\u7684\uff0c\u4ece API \u547d\u540d\u7684\u89d2\u5ea6\u6765\u770b\uff0c\u5176\u6838\u5fc3\u5b9e\u73b0\u65e0\u7591\u662f\u57fa\u4e8e\u53d1\u5e03/\u8ba2\u9605\u6a21\u5f0f\u3002"}),"\n",(0,s.jsxs)(t.p,{children:["\u4e24\u8005\u90fd\u6709\u4e00\u4e2a ",(0,s.jsx)(t.code,{children:"createStore()"})," API \u6765\u521b\u5efa\u4e00\u4e2a\u4e2d\u5fc3\u5316\u7684\u6570\u636e\u5b58\u50a8\u533a\uff0c\u540c\u65f6\u521b\u5efa\u7684 store \u5b9e\u4f8b\u5747\u4f1a\u66b4\u9732\u51fa\u4e3b\u52a8\u83b7\u53d6\u72b6\u6001\u7684 API ",(0,s.jsx)(t.code,{children:"getState()"}),"\uff0c\u8ba2\u9605\u72b6\u6001\u66f4\u65b0\u7684 API ",(0,s.jsx)(t.code,{children:"subscribe()"}),"\uff0c\u4ee5\u53ca\u66f4\u65b0\u72b6\u6001\u7684 API ",(0,s.jsx)(t.code,{children:"dispatch()"})," \u548c ",(0,s.jsx)(t.code,{children:"setState()"}),"\uff0c\u5f53\u7136 redux \u8fd8\u5f15\u5165\u4e86\u4e00\u4e2a ",(0,s.jsx)(t.code,{children:"reducer"})," \u7684\u6982\u5ff5\u548c API\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"\u4e24\u8005\u7684\u6838\u5fc3\u5e93\u5747\u53ea\u6709 1kb \u5927\u5c0f\uff0c\u800c zustand \u66f4\u5c0f\uff0c\u8fd9\u662f\u56e0\u4e3a zustand \u5b9e\u73b0\u66f4\u4e3a\u7b80\u5355\u4e00\u4e9b\uff0c\u5176\u5dee\u5f02\u4e3b\u8981\u96c6\u4e2d\u5728\u72b6\u6001\u66f4\u65b0\u673a\u5236\u4e0a\uff0c\u5176\u6b21\u662f\u72b6\u6001\u8ba2\u9605\u673a\u5236\u3002"}),"\n",(0,s.jsx)(t.h3,{id:"subscribe",children:(0,s.jsx)(t.code,{children:"subscribe()"})}),"\n",(0,s.jsxs)(t.p,{children:["\u5728\u72b6\u6001\u8ba2\u9605\u7684 ",(0,s.jsx)(t.code,{children:"subscribe()"})," API \u5b9e\u73b0\u4e2d\uff0czustand \u4ec5\u662f\u7b80\u5355\u7684\u76f4\u63a5\u5c06\u8ba2\u9605\u51fd\u6570\u6dfb\u52a0\u5230\u8ba2\u9605\u5217\u8868\u4e2d\uff0c\u540c\u65f6\u63d0\u4f9b\u4e86\u4e00\u4e2a ",(0,s.jsx)(t.code,{children:"selector"})," \u673a\u5236\u6765\u8fc7\u6ee4\u72b6\u6001\uff1a"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"// see https://github.com/pmndrs/zustand/blob/v3.6.5/src/vanilla.ts#L126\nconst subscribe: Subscribe<TState> = <StateSlice>(\n  listener: StateListener<TState> | StateSliceListener<StateSlice>,\n  selector?: StateSelector<TState, StateSlice>,\n  equalityFn?: EqualityChecker<StateSlice>\n) => {\n  if (selector || equalityFn) {\n    return subscribeWithSelector(\n      listener as StateSliceListener<StateSlice>,\n      selector,\n      equalityFn\n    );\n  }\n  listeners.add(listener as StateListener<TState>);\n  // Unsubscribe\n  return () => listeners.delete(listener as StateListener<TState>);\n};\n\n// see https://github.com/pmndrs/zustand/blob/v3.6.5/src/vanilla.ts#L107\nconst subscribeWithSelector = <StateSlice>(\n  listener: StateSliceListener<StateSlice>,\n  selector: StateSelector<TState, StateSlice> = getState as any,\n  equalityFn: EqualityChecker<StateSlice> = Object.is\n) => {\n  console.warn('[DEPRECATED] Please use `subscribeWithSelector` middleware');\n  let currentSlice: StateSlice = selector(state);\n  function listenerToAdd() {\n    const nextSlice = selector(state);\n    if (!equalityFn(currentSlice, nextSlice)) {\n      const previousSlice = currentSlice;\n      listener((currentSlice = nextSlice), previousSlice);\n    }\n  }\n  listeners.add(listenerToAdd);\n  // Unsubscribe\n  return () => listeners.delete(listenerToAdd);\n};\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u901a\u8fc7\u4e0a\u9762 ",(0,s.jsx)(t.code,{children:"listenerToAdd()"})," \u51fd\u6570\u53ef\u4ee5\u770b\u5230\uff0c\u5728\u8ba2\u9605\u72b6\u6001\u65f6\u63d0\u4f9b\u4e86 ",(0,s.jsx)(t.code,{children:"selector"})," \u7684\u8bdd\uff0c\u72b6\u6001\u66f4\u65b0\u65f6\u4f1a\u9996\u5148\u5c06\u72b6\u6001\u8fc7\u6ee4\u4e00\u904d\u518d\u901a\u77e5\u7ed9\u8ba2\u9605\u8005\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"// see https://github.com/pmndrs/zustand/blob/v3.6.5/src/vanilla.ts#L89\nconst setState: SetState<TState> = (partial, replace) => {\n  // ...\n  listeners.forEach((listener) => listener(state, previousState));\n  // ...\n};\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u901a\u8fc7 ",(0,s.jsx)(t.code,{children:"setState()"})," \u66f4\u65b0\u72b6\u6001\u65f6\uff0c\u6240\u6709\u8ba2\u9605\u51fd\u6570\u5c06\u4f1a\u8c03\u7528\uff0c\u540c\u65f6\u4f1a\u5c06\u65b0\u7684\u72b6\u6001\u548c\u65e7\u7684\u72b6\u6001\u4f20\u9012\u7ed9\u8ba2\u9605\u51fd\u6570\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"\u63a5\u4e0b\u6765\uff0c\u770b\u770b redux \u7684\u5b9e\u73b0\uff0credux \u5728\u6dfb\u52a0\u8ba2\u9605\u51fd\u6570\u65f6\u505a\u4e86\u4e00\u4e9b\u7279\u6b8a\u7684\u5224\u65ad\uff0c\u4ee5\u53ca\u7279\u6b8a\u5904\u7406\uff1a"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"// see https://github.com/reduxjs/redux/blob/v4.1.2/src/createStore.js#L128\nfunction subscribe(listener) {\n  // ...\n  if (isDispatching) {\n    throw new Error('...');\n  }\n\n  let isSubscribed = true;\n\n  ensureCanMutateNextListeners();\n  nextListeners.push(listener);\n\n  return function unsubscribe() {\n    if (!isSubscribed) {\n      return;\n    }\n\n    if (isDispatching) {\n      throw new Error('...');\n    }\n\n    isSubscribed = false;\n\n    ensureCanMutateNextListeners();\n    const index = nextListeners.indexOf(listener);\n    nextListeners.splice(index, 1);\n    currentListeners = null;\n  };\n}\n\n// see https://github.com/reduxjs/redux/blob/v4.1.2/src/createStore.js#L82\nfunction ensureCanMutateNextListeners() {\n  if (nextListeners === currentListeners) {\n    nextListeners = currentListeners.slice();\n  }\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u6839\u636e\u5b9e\u73b0\uff0credux \u901a\u8fc7 ",(0,s.jsx)(t.code,{children:"isDispatching"})," \u6807\u5fd7\u4f4d\u907f\u514d\u5728\u72b6\u6001\u66f4\u65b0\u671f\u95f4\u6dfb\u52a0\u8ba2\u9605\u51fd\u6570\uff0c\u4ee5\u53ca\u901a\u8fc7 ",(0,s.jsx)(t.code,{children:"ensureCanMutateNextListeners()"})," \u51fd\u6570\u5c06\u8ba2\u9605\u51fd\u6570\u5217\u8868\u505a\u4e86\u6d45\u62f7\u8d1d\u518d\u8fdb\u884c\u6dfb\u52a0\u548c\u5220\u9664\u64cd\u4f5c\uff0c\u8fd9\u90fd\u662f\u5bf9\u6f5c\u5728\u7684\u95ee\u9898\u7684\u89c4\u907f\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"// see https://github.com/reduxjs/redux/blob/v4.1.2/src/createStore.js#L197\nfunction dispatch(action) {\n  // ...\n\n  const listeners = (currentListeners = nextListeners);\n  for (let i = 0; i < listeners.length; i++) {\n    const listener = listeners[i];\n    listener();\n  }\n\n  return action;\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["redux \u901a\u8fc7 ",(0,s.jsx)(t.code,{children:"dispatch()"})," \u66f4\u65b0\u72b6\u6001\u65f6\uff0c\u7531\u4e8e\u5728\u8ba2\u9605\u65f6\u6ca1\u6709\u9ed8\u8ba4\u63d0\u4f9b ",(0,s.jsx)(t.code,{children:"selector"})," \u673a\u5236\uff0c\u6240\u4ee5\u4f1a\u65e0\u5dee\u522b\u7684\u901a\u77e5\u6240\u6709\u8ba2\u9605\u8005\uff0c\u540c\u65f6\u4e5f\u4e0d\u4f1a\u5c06\u65b0\u65e7\u72b6\u6001\u4f20\u9012\u7ed9\u8ba2\u9605\u51fd\u6570\uff0c\u5f53\u7136\u5728\u5b98\u65b9\u793a\u4f8b\u4ee3\u7801\u4e2d\u53ef\u4ee5\u770b\u5230\uff0c\u5b98\u65b9\u63a8\u8350\u5728\u8ba2\u9605\u51fd\u6570\u4e2d\u4e3b\u52a8\u901a\u8fc7 ",(0,s.jsx)(t.code,{children:"getState()"})," \u83b7\u53d6\u65b0\u7684\u72b6\u6001\u4ee5\u53ca\u5b8c\u6210 selector \u64cd\u4f5c\u3002\u53ef\u4ee5\u8bf4\uff0c\u7531\u4e8e redux \u548c zustand \u8bbe\u8ba1\u7406\u5ff5\u4e0d\u540c\uff0c\u8ba2\u9605\u7684\u5b9e\u73b0\u65b9\u5f0f\u4e5f\u7565\u6709\u5dee\u522b\uff0c\u524d\u8005\u63a7\u5236\u7684\u66f4\u7ec6\u81f4\uff0c\u800c\u7075\u6d3b\u6027\u5f88\u9ad8\uff0c\u800c\u540e\u8005\u5728\u4fdd\u6301\u7b80\u5355\u6027\u7684\u540c\u65f6\u4e5f\u6ca1\u6709\u727a\u7272\u7075\u6d3b\u6027\u3002"]}),"\n",(0,s.jsxs)(t.h3,{id:"setstate--dispatch",children:[(0,s.jsx)(t.code,{children:"setState()"})," && ",(0,s.jsx)(t.code,{children:"dispatch()"})]}),"\n",(0,s.jsxs)(t.p,{children:["\u72b6\u6001\u66f4\u65b0\u673a\u5236\u662f\u4e24\u8005\u5b9e\u73b0\u6700\u5927\u7684\u4e0d\u540c\uff0czustand \u63d0\u4f9b\u4e00\u4e2a ",(0,s.jsx)(t.code,{children:"setState()"})," \u51fd\u6570\u6765\u66f4\u65b0\u72b6\u6001\uff1a"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"// see https://github.com/pmndrs/zustand/blob/v3.6.5/src/vanilla.ts#L89\nconst setState: SetState<TState> = (partial, replace) => {\n  // TODO: Remove type assertion once https://github.com/microsoft/TypeScript/issues/37663 is resolved\n  // https://github.com/microsoft/TypeScript/issues/37663#issuecomment-759728342\n  const nextState =\n    typeof partial === 'function'\n      ? (partial as (state: TState) => TState)(state)\n      : partial;\n  if (nextState !== state) {\n    const previousState = state;\n    state = replace\n      ? (nextState as TState)\n      : Object.assign({}, state, nextState);\n    listeners.forEach((listener) => listener(state, previousState));\n  }\n};\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u6839\u636e\u6e90\u7801\u5b9e\u73b0\u6765\u770b\uff0czustand \u901a\u8fc7 ",(0,s.jsx)(t.code,{children:"Object.assign"})," \u51fd\u6570\u5408\u5e76\u66f4\u65b0\u72b6\u6001\uff0c\u540c\u65f6\u63d0\u4f9b ",(0,s.jsx)(t.code,{children:"replace"})," \u6807\u5fd7\u4f4d\u76f4\u63a5\u5c06\u65e7\u72b6\u6001\u5b8c\u5168\u66ff\u6362\u3002"]}),"\n",(0,s.jsxs)(t.p,{children:["\u800c redux \u7684\u72b6\u6001\u66f4\u65b0\u5219\u8981\u590d\u6742\u4e00\u4e9b\uff0c\u4e3b\u8981\u662f\u5b98\u65b9\u63a8\u8350\u7684\u7f16\u7a0b\u6a21\u5f0f\u5c06\u72b6\u6001\u66f4\u65b0\u62c6\u5206\u4e3a\u591a\u4e2a\u6b65\u9aa4\uff0c",(0,s.jsx)(t.code,{children:"dispatch()"})," \u51fd\u6570\u89e6\u53d1\u4e00\u4e2a ",(0,s.jsx)(t.code,{children:"Action"}),"\uff0c\u800c\u5177\u4f53\u5904\u7406 Action \u4ee5\u53ca\u72b6\u6001\u5408\u5e76\u7684\u64cd\u4f5c\u5747\u7531 ",(0,s.jsx)(t.code,{children:"Reducer"})," \u51fd\u6570\u5b8c\u6210\uff0c\u8be5\u51fd\u6570\u662f\u4e00\u4e2a\u7eaf\u51fd\u6570\u3002\u81f3\u4e8e\u4e3a\u4ec0\u4e48\u8981\u8fd9\u4e48\u8bbe\u8ba1\uff0c\u5b98\u65b9\u6709\u8bf4\u660e\uff0c\u7eaf\u51fd\u6570\u5bf9\u4e8e\u72b6\u6001\u53d8\u5316\u6765\u8bf4\u662f\u53ef\u9884\u6d4b\u7684\uff0c\u800c\u4e14\u5229\u4e8e\u6d4b\u8bd5\uff0c\u66f4\u662f\u5b9e\u73b0\u65f6\u95f4\u65c5\u884c\u7c7b\u4f3c\u529f\u80fd\u7684\u57fa\u7840\u3002"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"// see https://github.com/reduxjs/redux/blob/v4.1.2/src/createStore.js#L197\nfunction dispatch(action) {\n  if (!isPlainObject(action)) {\n    throw new Error(\n      `Actions must be plain objects. Instead, the actual type was: '${kindOf(\n        action\n      )}'. You may need to add middleware to your store setup to handle dispatching other values, such as 'redux-thunk' to handle dispatching functions. See https://redux.js.org/tutorials/fundamentals/part-4-store#middleware and https://redux.js.org/tutorials/fundamentals/part-6-async-logic#using-the-redux-thunk-middleware for examples.`\n    );\n  }\n\n  if (typeof action.type === 'undefined') {\n    throw new Error(\n      'Actions may not have an undefined \"type\" property. You may have misspelled an action type string constant.'\n    );\n  }\n\n  if (isDispatching) {\n    throw new Error('Reducers may not dispatch actions.');\n  }\n\n  try {\n    isDispatching = true;\n    currentState = currentReducer(currentState, action);\n  } finally {\n    isDispatching = false;\n  }\n\n  const listeners = (currentListeners = nextListeners);\n  for (let i = 0; i < listeners.length; i++) {\n    const listener = listeners[i];\n    listener();\n  }\n\n  return action;\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u6839\u636e\u6e90\u7801\u5b9e\u73b0\u6765\u770b\uff0c\u8fd9\u91cc\u51fa\u73b0\u4e86 ",(0,s.jsx)(t.code,{children:"isDispatching"})," \u6807\u5fd7\u4f4d\uff0c\u4e3b\u8981\u662f\u7528\u6765\u9650\u5236\u72b6\u6001\u66f4\u65b0\u8fc7\u7a0b\u4e2d\u4e0d\u80fd\u518d\u6b21\u53d1\u8d77\u72b6\u6001\u66f4\u65b0\u64cd\u4f5c\uff0c\u907f\u514d\u51fa\u73b0\u9519\u8bef\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"\u4e0d\u8fc7\uff0c\u6709\u4e00\u70b9\u503c\u5f97\u63d0\u4e00\u4e0b\uff0credux \u9ed8\u8ba4\u4e0d\u652f\u6301\u5f02\u6b65\u66f4\u65b0\u72b6\u6001\uff0c\u9700\u8981\u501f\u52a9 redux-thunk \u5e93\u6765\u652f\u6301\uff1b\u800c zustand \u672c\u8eab\u5219\u662f\u652f\u6301\u5f02\u6b65\u66f4\u65b0\u72b6\u6001\u7684\u3002"}),"\n",(0,s.jsx)(t.p,{children:"\u6839\u636e\u4ee5\u4e0a\u5206\u6790\u6765\u770b\uff0c\u5b9e\u9645\u4e0a\u6838\u5fc3\u5b9e\u73b0\u662f\u76f8\u4f3c\u7684\uff0c\u800c\u4e14 zustand \u4f5c\u4e3a\u540e\u6765\u8005\uff0c\u5bf9 redux \u6709\u501f\u9274\u4e5f\u6709\u7b80\u5316\u7684\u5730\u65b9\uff0c\u6ee1\u8db3\u72b6\u6001\u7ba1\u7406\u7684\u6838\u5fc3\u7b80\u5355\u9700\u6c42\u662f\u6ca1\u6709\u591a\u5927\u95ee\u9898\u7684\uff0c\u53ef\u4f5c\u4e3a redux \u7684\u4e00\u4e2a\u66ff\u4ee3\u65b9\u6848\u3002"}),"\n",(0,s.jsx)(t.h3,{id:"reactjs-\u9002\u914d",children:"React.js \u9002\u914d"}),"\n",(0,s.jsx)(t.p,{children:"\u5982\u679c\u8bf4\uff0c\u6838\u5fc3\u5e93\u5dee\u5f02\u8f83\u5c0f\uff0c\u800c\u4e14\u5305\u5c3a\u5bf8\u76f8\u8fd1\u7684\u8bdd\uff0c\u90a3\u4e48\u6700\u5927\u7684\u5dee\u5f02\u5219\u51fa\u73b0\u5728\u5bf9 React.js \u5e93\u7684\u9002\u914d\u4e0a\u9762\u3002"}),"\n",(0,s.jsx)(t.p,{children:"zustand \u51fa\u73b0\u7684\u8f83\u665a\uff0c\u76ee\u524d Hook API \u5df2\u7ecf\u6210\u4e3a React.js \u793e\u533a\u7684\u4e3b\u6d41\uff0c\u6240\u4ee5 zustand \u5728\u5bf9\u5176\u9002\u914d\u7684\u65f6\u5019\u4e5f\u662f\u4ee5 Hook API \u7684\u65b9\u5f0f\u5b9e\u73b0\uff0c\u6ca1\u6709\u63d0\u4f9b\u7c7b\u7ec4\u4ef6\u7684\u9002\u914d\u3002"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-typescript",children:"// see https://github.com/pmndrs/zustand/blob/v3.6.5/src/index.ts#L64\nfunction create<\n  TState extends State,\n  CustomSetState,\n  CustomGetState,\n  CustomStoreApi extends StoreApi<TState>\n>(\n  createState:\n    | StateCreator<TState, CustomSetState, CustomGetState, CustomStoreApi>\n    | CustomStoreApi\n): UseBoundStore<TState, CustomStoreApi> {\n  // ...\n  const useStore: any = <StateSlice>(\n    selector: StateSelector<TState, StateSlice> = api.getState as any,\n    equalityFn: EqualityChecker<StateSlice> = Object.is\n  ) => {\n    const [, forceUpdate] = useReducer((c) => c + 1, 0) as [never, () => void];\n    // ...\n    const stateBeforeSubscriptionRef = useRef(state);\n    useIsomorphicLayoutEffect(() => {\n      const listener = () => {\n        try {\n          const nextState = api.getState();\n          const nextStateSlice = selectorRef.current(nextState);\n          if (\n            !equalityFnRef.current(\n              currentSliceRef.current as StateSlice,\n              nextStateSlice\n            )\n          ) {\n            stateRef.current = nextState;\n            currentSliceRef.current = nextStateSlice;\n            forceUpdate();\n          }\n        } catch (error) {\n          erroredRef.current = true;\n          forceUpdate();\n        }\n      };\n      const unsubscribe = api.subscribe(listener);\n      if (api.getState() !== stateBeforeSubscriptionRef.current) {\n        listener(); // state has changed before subscription\n      }\n      return unsubscribe;\n    }, []);\n\n    const sliceToReturn = hasNewStateSlice\n      ? (newStateSlice as StateSlice)\n      : currentSliceRef.current;\n    useDebugValue(sliceToReturn);\n    return sliceToReturn;\n  };\n\n  // ...\n  return useStore;\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["zustand \u5c06 ",(0,s.jsx)(t.code,{children:"createStore"})," \u51fd\u6570\u7684\u8fd4\u56de\u503c\u4f5c\u4e3a\u4e00\u4e2a\u81ea\u5b9a\u4e49 hook \u6765\u5b9e\u73b0\uff0c\u5176\u4e2d\u4e3a\u4e86\u8ba9 React.js \u7ec4\u4ef6\u80fd\u611f\u77e5\u5230\u72b6\u6001\u66f4\u65b0\uff0c\u662f\u5229\u7528 ",(0,s.jsx)(t.code,{children:"useEffect"})," \u6765\u5b8c\u6210\u8ba2\u9605\u64cd\u4f5c\uff0c\u800c\u72b6\u6001\u66f4\u65b0\u53d1\u5e03\u540e\uff0c\u5219\u901a\u8fc7 ",(0,s.jsx)(t.code,{children:"forceUpdate()"})," \u6765\u5f3a\u5236\u7ec4\u4ef6\u8fdb\u884c rerender \u4ee5\u83b7\u53d6\u6700\u65b0\u7684\u72b6\u6001\u3002"]}),"\n",(0,s.jsx)(t.p,{children:"\u8fd9\u91cc\uff0c\u770b\u770b\u5982\u4f55\u5728\u51fd\u6570\u7ec4\u4ef6\u4e2d\u4f7f\u7528 zustand\uff1a"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-js",children:"import create from 'zustand';\n\n// Store\nconst useStore = create((set) => ({\n  bears: 0,\n  increasePopulation: () => set((state) => ({ bears: state.bears + 1 })),\n  removeAllBears: () => set({ bears: 0 }),\n}));\n\n// Component\nfunction BearCounter() {\n  const bears = useStore((state) => state.bears);\n  return <h1>{bears} around here ...</h1>;\n}\n\nfunction Controls() {\n  const increasePopulation = useStore((state) => state.increasePopulation);\n  return <button onClick={increasePopulation}>one up</button>;\n}\n"})}),"\n",(0,s.jsxs)(t.p,{children:["\u5b9e\u9645\u4e0a\uff0c\u7528\u6cd5\u548c react-redux \u975e\u5e38\u76f8\u4f3c\uff0c\u4f46\u83b7\u53d6\u72b6\u6001\u4e0e\u66f4\u65b0\u72b6\u6001\u5747\u53ea\u9700\u8981\u4f7f\u7528 ",(0,s.jsx)(t.code,{children:"useStore"})," \u4e00\u4e2a API \u5373\u53ef\u5b8c\u6210\u4e1a\u52a1\u3002"]}),"\n",(0,s.jsxs)(t.p,{children:["\u7136\u800c\uff0creact-redux \u7684\u5b9e\u73b0\u5219\u8981\u590d\u6742\u7684\u591a\u3002\u7531\u4e8e\u5176\u51fa\u73b0\u7684\u8f83\u65e9\uff0c\u6240\u4ee5\u540c\u65f6\u9002\u914d\u4e86\u7c7b\u7ec4\u4ef6\u548c\u51fd\u6570\u7ec4\u4ef6\u3002\u8fd9\u91cc\u4e0d\u518d\u7ec6\u7a76 react-redux \u7684\u5177\u4f53\u5b9e\u73b0\uff0c\u4f46\u5176\u4e0e zustand \u6700\u5927\u7684\u5dee\u5f02\u5219\u5728\u4e8e\u628a\u72b6\u6001\u653e\u5728\u4e86 ",(0,s.jsx)(t.code,{children:"Context"})," \u4e2d\u5b58\u50a8\uff0c\u6240\u4ee5\u9700\u8981\u4f7f\u7528 ",(0,s.jsx)(t.code,{children:"Provider"})," \u5c06\u9875\u9762\u7684\u6839\u7ec4\u4ef6\u5305\u88f9\u8d77\u6765\u624d\u80fd\u4f7f\u7528\u3002redux \u7684 ",(0,s.jsx)(t.code,{children:"useSelector()"})," Hook API \u4e0e zustand \u4e0a\u9762\u63d0\u5230\u7684 ",(0,s.jsx)(t.code,{children:"useStore()"})," \u7684\u5b9e\u73b0\u903b\u8f91\u4e5f\u975e\u5e38\u76f8\u4f3c\u3002"]}),"\n",(0,s.jsx)(t.h3,{id:"\u8c03\u5f0f\u5de5\u5177",children:"\u8c03\u5f0f\u5de5\u5177"}),"\n",(0,s.jsx)(t.p,{children:"\u4e00\u4e2a\u6838\u5fc3\u5de5\u5177\u5e93\u597d\u4e0d\u597d\u7528\uff0c\u4e0d\u4ec5\u8981\u80fd\u89e3\u51b3\u4e1a\u52a1\u95ee\u9898\uff0c\u540c\u65f6\u4e5f\u8981\u80fd\u63d0\u4f9b\u826f\u597d\u7684\u5f00\u53d1\u4f53\u9a8c\uff0credux \u4e4b\u6240\u4ee5\u80fd\u6210\u4e3a React.js \u793e\u533a\u666e\u904d\u91c7\u7528\u7684\u72b6\u6001\u7ba1\u7406\u65b9\u6848\uff0c\u4e0d\u4ec5\u5728\u4e8e\u5176\u5b9e\u73b0\u7684\u4f18\u96c5\uff0c\u5021\u5bfc\u7684\u4f18\u79c0\u7684\u6a21\u5f0f\uff0c\u66f4\u5728\u4e8e\u5176\u914d\u5957\u7684\u8c03\u8bd5\u5de5\u5177\u3001\u4e2d\u95f4\u4ef6\u4e5f\u975e\u5e38\u597d\u7528\u3002\u6240\u4ee5\uff0czustand \u4f5c\u4e3a\u540e\u6765\u8005\u5e76\u6ca1\u6709\u91cd\u590d\u9020\u8f6e\u5b50\uff0c\u800c\u662f\u5c3d\u6700\u5927\u7684\u53ef\u80fd\u91cd\u7528 redux \u793e\u533a\u7684\u5f00\u6e90\u65b9\u6848\uff0c\u8fd9\u4e00\u70b9\u4e5f\u662f\u6bd4\u8f83\u597d\u7684\uff0c\u81f3\u5c11\u4ece redux \u8fc1\u79fb\u5230 zustand \u4e0d\u4f1a\u6709\u592a\u5927\u7684\u56f0\u96be\uff0c\u5f00\u53d1\u4f53\u9a8c\u4e0a\u6765\u8bf4\u8fd8\u662f\u4e0d\u9519\u7684\u3002"}),"\n",(0,s.jsx)(t.h2,{id:"\u7ed3\u8bed",children:"\u7ed3\u8bed"}),"\n",(0,s.jsx)(t.p,{children:"\u81f3\u6b64\uff0c\u5b8c\u6210\u4e86\u5bf9 zustand \u8fd9\u4e2a\u8f7b\u91cf\u7ea7\u7684\u72b6\u6001\u7ba1\u7406\u65b9\u6848\u7684\u63a2\u7d22\uff0c\u81f3\u5c11\u5728\u6ee1\u8db3\u72b6\u6001\u7ba1\u7406\u7b80\u5355\u7684\u6838\u5fc3\u9700\u6c42\u3001\u4f7f\u7528\u7b80\u5355\u3001\u5177\u5907\u826f\u597d\u7684\u8c03\u5f0f\u5de5\u5177\u7b49\u51e0\u65b9\u9762\u6765\u8bf4\u8fd8\u662f\u4e0d\u9519\u7684\uff0c\u4f5c\u4e3a redux \u7684\u8f7b\u91cf\u7ea7\u66ff\u4ee3\u65b9\u6848\uff0c\u5b8c\u5168\u503c\u5f97\u4e00\u8bd5\u3002"}),"\n",(0,s.jsx)(t.h2,{id:"\u53c2\u8003",children:"\u53c2\u8003"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://redux.js.org/",children:"redux"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://react-redux.js.org/",children:"react-redux"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://zustand.surge.sh/",children:"zustand"})}),"\n",(0,s.jsx)(t.li,{children:(0,s.jsx)(t.a,{href:"https://javascript.plainenglish.io/lets-build-our-own-redux-9384b283529c",children:"Let\u2019s build our own Redux"})}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.a)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},11151:(e,t,n)=>{n.d(t,{Z:()=>l,a:()=>c});var s=n(67294);const r={},i=s.createContext(r);function c(e){const t=s.useContext(i);return s.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:c(e.components),s.createElement(i.Provider,{value:t},e.children)}}}]);