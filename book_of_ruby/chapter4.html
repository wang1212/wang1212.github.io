<!DOCTYPE html>
<html lang="en">
<body>
	<header class="hidden-sm-down text-xs-left">
		<p class="h1 text-xs-center">Chapter Four</p><hr />
		<p class="h2 text-xs-center">Arrays and Hashes</p>
		<ul>
			<li class="h3">Arrays</li>
			<li class="h3">Hashes</li>
		</ul>
		<p class="h2 text-xs-center">Digging Deeper</p>
		<ul>
			<li class="h3">Treating Hashes As Arrays</li>
			<li class="h3">Appending and Concatenating</li>
			<li class="h3">Matrices and Vectors</li>
			<li class="h3">Sets</li>
		</ul>
	</header>
	<h1 class="page-title text-xs-center">第四章</h1><hr />
	<section>
		<h2 class="text-xs-center">数组与哈希表</h2>
		<p class="head-indent">
			到目前为止，我们一般一直在使用单个对象。 在这一章中我们将会了解如何创建对象列表。 我们首先来看最常见的列表结构类型——数组。
		</p>
		<section>
			<h3>数组</h3>
			<div style="font-weight: 600"><span class="fa fa-file-code-o"></span>&nbsp;array0.rb</div>
			<div class="note">
				<p class="head-indent">
					数组是每个元素都可以被索引到的有序集合。在 Ruby 中，（与许多其它语言不同）一个 Array 可以包含不同类型的元素，例如字符串、整数和浮点数，甚至是方法的返回值。
				</p>
				<pre class="language-ruby line-numbers"><code>a1 = [1, 'two', 3.0, array_length(a0)]</code></pre>
				<p class="head-indent">
					数组中的第一个项目的索引为 0，这意味着数组中的最后一个元素的索引为数组中元素总数减 1。如上所示，给定一个数组<code>a1</code>，然后访问其第一个和最后一个元素：
				</p>
				<pre class="language-ruby line-numbers"><code>a1[0]  # returns 1st item (at index 0)
a1[3]  # returns 4th item (at index 3)</code></pre>
			</div>
			<p class="head-indent">
				我们已经使用了数次数组，例如在第二章的 <strong>2adventure.rb</strong> 中我们使用了一个数组来存储房间的地图：
			</p>
			<pre class="language-ruby line-numbers"><code>mymap = Map.new([room1, room2, room3])</code></pre>
			<section>
				<h4>创建数组</h4>
				<p class="head-indent">
					与其他许多编程语言一样，Ruby 使用方括号来界定数组。你可以使用逗号分隔多个值很容易的创建一个数组，并将其赋给一个变量。
				</p>
				<pre class="language-ruby line-numbers"><code>arr = ['one','two','three','four']</code></pre>
				<div style="font-weight: 600"><span class="fa fa-file-code-o"></span>&nbsp;array1.rb</div>
				<p class="head-indent">
					与 Ruby 中其它的东西一样，数组也是对象。你可能会猜到，正如字符串一样，它由<code>Array</code>类定义，索引从 0 开始。你可以将索引放在方括号中得到相应元素，如果索引无效，将会返回<code>nil</code>：
				</p>
				<pre class="language-ruby line-numbers"><code>arr = ['a', 'b', 'c']
puts(arr[0]) # shows "a"
puts(arr[1]) # shows "b"
puts(arr[2]) # shows "c"
puts(arr[3]) # nil</code></pre>
				<div style="font-weight: 600"><span class="fa fa-file-code-o"></span>&nbsp;array2.rb</div>
				<p class="head-indent">
					在数组中混合数据类型是被允许的，甚至也可以包含一些产生值的表达式。假设你创建了这个方法：
				</p>
				<pre class="language-ruby line-numbers"><code>def hello
	return "hello world"
end</code></pre>
				<p class="head-indent">你可以这样声明一个数组：</p>
				<pre class="language-ruby line-numbers"><code>x = [1+2, hello, `dir`]</code></pre>
				<p class="head-indent">
					这里，第一个元素是整数 3，第二个元素是字符串 “hello world”（由<code>hello</code>方法返回）。如果你在 Windows 上运行，第三个数组将是一个包含目录列表的字符串。这是因为<code>`dir`</code>反引号字符串是可以被操作系统执行的命令（见第三章）。因此，数组中的最后一个位置将被 <strong>dir</strong> 命令返回的文件名字符串填充。如果你是运行在不同的操作系统上，这时候应该替换一个合适的命令。
				</p>
				<div style="font-weight: 600"><span class="fa fa-file-code-o"></span>&nbsp;dir_array.rb</div>
				<div class="note">
					<p><b>创建一个文件名的数组</b></p>
					<p class="head-indent">
						许多 Ruby 类有返回值为数组的方法。例如，Dir 类用来执行在磁盘上目录操作，拥有<code>entries</code>方法。传递给该方法一个目录名称，将会返回一个包含文件名列表的数组。
					</p>
					<pre class="language-ruby line-numbers"><code>Dir.entries('C:\\') # returns an array of files in C:\</code></pre>
				</div>
				<p class="head-indent">
					如果你要创建一个包含单引号字符串的数组，但是输入所有引号又很麻烦，一种简洁的方式就是使用<code>%w</code>和将不带引号的字符串以空格分隔放入圆括号中的形式表示（或者使用<code>%W</code>表示双引号字符串，如第三章所述）：
				</p>
				<div style="font-weight: 600"><span class="fa fa-file-code-o"></span>&nbsp;array2.rb</div>
				<pre class="language-ruby line-numbers"><code>y = %w(this is an array of strings)</code></pre>
				<p class="head-indent">
					你也可以使用通常的构造器来（new）创建一个数组，你可以同时将一个整数传递给构造方法，来创建一个特定大小（每个元素值为<code>nil</code>）的数组。当然，你也可以传递两个参数，第一个参数指定数组大小，第二个参数指定要放入数组中的元素：
				</p>
				<pre class="language-ruby line-numbers"><code>a = Array.new # an empty array
a = Array.new(2) # [nil,nil]
a = Array.new(2, "hello world")  # ["hello world", "hello world"]</code></pre>
			</section>
			<section>
				<h4>多维数组</h4>
				<p class="head-indent">
					要创建一个多维数组，你可以先创建一个数组，然后再将其它数组作为元素放入该数组中。例如，这将创建一个包含两个数组元素的数组。
				</p>
				<pre class="language-ruby line-numbers"><code>a = Array.new(2)
a[0]= Array.new(2,'hello')
a[1]= Array.new(2,'world')</code></pre>
				<div class="note">
					你还可以将数组对象作为参数传递给数组的<code>new</code>方法来创建多维数组。不过要注意，虽然在传递数组参数时不适用圆括号是可以的，但你如果不在方法名和参数之间加入空格，Ruby 将认为这是一个语法错误，所以在传递参数时，请一定要使用圆括号。
				</div>
				<p class="head-indent">
					也可以使用方括号将数组嵌套在一起。这是创建了一个包含四个数组元素的 2 维数组，每个数组元素包含四个整数元素：
				</p>
				<pre class="language-ruby line-numbers"><code>a = [  [1,2,3,4],
[5,6,7,8],
[9,10,11,12],
[13,14,15,16]  ]</code></pre>
				<p class="head-indent">
					在上面显示的代码中，我将四个子数组分别放在不同行中，这并不是强制性的，但这样的写法有助于构建多元化的数组结构，通过将每个子数组显示为一行，类似电子表格中的行。当谈到数组中的数组时，可以很方便的将每个子数组引用为外层数组的行。
				</p>
				<div style="font-weight: 600"><span class="fa fa-file-code-o"></span>&nbsp;multi_array.rb</div>
				<p class="head-indent">
					有关更多的使用多维数组的示例，请加载 <strong>multi_array.rb</strong> 程序。首先创建了包含另外两个数组的多维数组<code>multiarr</code>，而这两个数组中在多维数组中的索引分别为 0 和 1。
				</p>
				<pre class="language-ruby line-numbers"><code>multiarr = [['one','two','three','four'],[1,2,3,4]]</code></pre>
			</section>
			<section>
				<h4>数组迭代</h4>
				<p class="head-indent">
					你可以使用<code>for</code>循环来遍历数组访问数组中的元素，循环将会遍历位于索引 0 和 1 处的子数组两个元素：
				</p>
				<pre class="language-ruby line-numbers"><code>for i in multiarr
	puts(i.inspect)
end</code></pre>
				<p class="head-indent">将会输出：</p>
				<pre class="language-ruby"><code>["one", "two", "three", "four"]
[1, 2, 3, 4]</code></pre>
				<p class="head-indent">
					那么，你如何子数组中的元素呢？如果元素数量是固定的，你可以指定多个不同迭代变量，这时将会匹配子数组中对应索引位置的元素。
				</p>
				<p class="head-indent">这两个子数组有四个元素，所以你可以使用四个迭代变量：</p>
				<pre class="language-ruby line-numbers"><code>for (a,b,c,d) in multiarr
	print("a=#{a}, b=#{b}, c=#{c}, d=#{d}\n" )
end</code></pre>
				<div class="note">
					<p><b>迭代器和 for 循环</b></p>
					<p class="head-indent"><code>for</code>循环中的代码对每一个迭代元素进行执行，语法可以总结如下：</p>
					<pre class="language-ruby"><code>for &lt;one or more variables&gt; in &lt;expression&gt; do
	&lt;code to run&gt;
end</code></pre>
					<p class="head-indent">
						当提供多个变量时，会将这些变量传递给代码里面的<code>for...end</code>块，如同给方法传递参数一样。在这里，你可以将<code>(a,b,c,d)</code>作为四个参数进行初始化，每一次匹配<code>for</code>循环所遍历的多维数组<code>multiarr</code>的每一行：
					</p>
					<pre class="language-ruby line-numbers"><code>for (a,b,c,d) in multiarr
	print("a=#{a}, b=#{b}, c=#{c}, d=#{d}\n" )
end</code></pre>
					<p class="head-indent">我们将在下一章中更深入地研究<code>for</code>循环和其他迭代器。</p>
				</div>
				<div style="font-weight: 600"><span class="fa fa-file-code-o"></span>&nbsp;multi_array2.rb</div>
				<p class="head-indent">您还可以使用for循环来单独迭代每个子数组中的所有元素：</p>
				<pre class="language-ruby line-numbers"><code>for s in multiarr[0]
	puts(s) 
end
for s in multiarr[1]
	puts(s) 
end</code></pre>
				<p class="head-indent">
					以上两种技术（多个迭代变量和多个<code>for</code>循环）都需要满足两个条件：a）你需要知道多维数组有几行或者几列；b）每个子数组都包含相同数量的元素。
				</p>
				<p class="head-indent">
					为了更灵活的迭代多维数组，你可以使用嵌套的<code>for</code>循环。一个外部循环遍历每一行，内部循环则遍历当前行中的元素。这种技术在子数组有不同数量元素时都可以正常运行：
				</p>
				<pre class="language-ruby line-numbers"><code>for row in multiarr
	for item in row
		puts(item)
	end
end</code></pre>
			</section>
			<section>
				<h4>数组索引</h4>
				<p class="head-indent">
					与字符串一样（参见第三章），你可以使用负数从末尾开始索引元素，也可以使用范围来索引：
				</p>
				<div style="font-weight: 600"><span class="fa fa-file-code-o"></span>&nbsp;array_index.rb</div>
				<pre class="language-ruby line-numbers"><code>arr = ['h','e','l','l','o',' ','w','o','r','l','d']

print( arr[0,5] )  #=> "hello"
print( arr[-5,5 ] ) #=> "world"
print( arr[0..4] ) #=> "hello"
print( arr[-5..-1] ) #=> "world"</code></pre>
				<p class="head-indent">
					注意，与字符串一样，当提供两个整数以返回一个来自数组的连续几项的元素，第一个整数作为起始索引，第二个则是元素数目（并非终止索引）：
				</p>
				<pre class="language-ruby line-numbers"><code>arr[0,5]  # returns 5 chars - ["h", "e", "l", "l", "o"]</code></pre>
				<div style="font-weight: 600"><span class="fa fa-file-code-o"></span>&nbsp;array_assign.rb</div>
				<p class="head-indent">
					你也可以利用索引来进行数组中元素的赋值，例如，我们首先创建一个空的数组，然后对索引为 0，1 和 3 的位置进行赋值，而没有赋值的索引为 2 的位置将填充一个默认值<code>nil</code>：
				</p>
				<pre class="language-ruby line-numbers"><code>arr = []

arr[0] = [0]
arr[1] = ["one"]
arr[3] = ["a", "b", "c"]

# arr now contains:
# [[0], ["one"], nil, ["a", "b", "c"]]</code></pre>
				<p class="head-indent">同样地，你也可以使用范围，负索引等：</p>
				<pre class="language-ruby line-numbers"><code>arr2 = ['h','e','l','l','o',' ','w','o','r','l','d']

arr2[0] = 'H'
arr2[2,2] = 'L', 'L'
arr2[4..6] = 'O','-','W'
arr2[-4,4] = 'a','l','d','o'

# arr2 now contains:
# ["H", "e", "L", "L", "O", "-", "W", "a", "l", "d", "o"]</code></pre>
			</section>
			<section>
				<h4>数组拷贝</h4>
			</section>
			<section>
				<h4>数组的平均数测试</h4>
			</section>
			<section>
				<h4>数组排序</h4>
			</section>
			<section>
				<h4>比较值</h4>
			</section>
			<section>
				<h4>数组方法</h4>
			</section>
		</section>
		<section>
			<h3>哈希表</h3>
			<section>
				<h4>创建哈希表</h4>
			</section>
			<section>
				<h4>哈希表索引</h4>
			</section>
			<section>
				<h4>哈希表拷贝</h4>
			</section>
			<section>
				<h4>哈希表排序</h4>
			</section>
			<section>
				<h4>哈希表方法</h4>
			</section>
		</section>
	</section>
	<section>
		<h2>深入探索</h2>
		<section>
			<h3>以数组方式操作哈希表</h3>
		</section>
		<section>
			<h3>附加和连接</h3>
		</section>
		<section>
			<h3>矩阵和向量</h3>
		</section>
		<section>
			<h3>Sets</h3>
		</section>
	</section>

	<script src="/source/js/prism.js"></script>
</body>
</html>